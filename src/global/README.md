# ğŸŒ Global Layer

**ì• í”Œë¦¬ì¼€ì´ì…˜ ì „ì—­ ì„¤ì • ë° ì»¨í…ìŠ¤íŠ¸ ê´€ë¦¬ ë ˆì´ì–´**

## ğŸ¯ ì—­í• ê³¼ ì±…ì„

Global ë ˆì´ì–´ëŠ” **ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ì „ì—­ì  ê´€ì‹¬ì‚¬**ë¥¼ ë‹´ë‹¹í•˜ëŠ” ë ˆì´ì–´ë¡œ, ë‹¤ìŒê³¼ ê°™ì€ ì—­í• ì„ ìˆ˜í–‰í•©ë‹ˆë‹¤:

- **í™˜ê²½ ì„¤ì • ê´€ë¦¬** - ê°œë°œ/ìš´ì˜ í™˜ê²½ë³„ ì„¤ì •ê°’ ê´€ë¦¬
- **ì „ì—­ ì»¨í…ìŠ¤íŠ¸ ì œê³µ** - ì• í”Œë¦¬ì¼€ì´ì…˜ ì „ì²´ì—ì„œ ê³µìœ ë˜ëŠ” ìƒíƒœì™€ ê¸°ëŠ¥
- **ì´ˆê¸°í™” ë° ë¶€íŠ¸ìŠ¤íŠ¸ë˜í•‘** - ì•± ì‹œì‘ ì‹œ í•„ìš”í•œ ì„¤ì • ë° ì´ˆê¸°í™” ë¡œì§
- **í¬ë¡œìŠ¤ ì»·íŒ… ê´€ì‹¬ì‚¬** - ë¡œê¹…, ëª¨ë‹ˆí„°ë§, ì—ëŸ¬ ì¶”ì  ë“±

## ğŸ“¦ ë ˆì´ì–´ êµ¬ì„± ìš”ì†Œ

### `/config`
**ëª©ì **: ì• í”Œë¦¬ì¼€ì´ì…˜ ì „ë°˜ì˜ ì„¤ì •ê°’ ì¤‘ì•™ ê´€ë¦¬
- í™˜ê²½ë³€ìˆ˜ ê¸°ë°˜ ì„¤ì • (ê°œë°œ/ìŠ¤í…Œì´ì§•/ìš´ì˜)
- í”¼ì²˜ í”Œë˜ê·¸ ê¸°ë³¸ê°’
- ì™¸ë¶€ ì„œë¹„ìŠ¤ ì—°ê²° ì •ë³´
- ì„±ëŠ¥ ë° ìµœì í™” ì„¤ì •

### `/providers`
**ëª©ì **: ì• í”Œë¦¬ì¼€ì´ì…˜ ì „ì—­ ì»¨í…ìŠ¤íŠ¸ ë° í”„ë¡œë°”ì´ë” ê´€ë¦¬
- React Context ê¸°ë°˜ ì „ì—­ ìƒíƒœ ì œê³µì
- ì¨ë“œíŒŒí‹° ë¼ì´ë¸ŒëŸ¬ë¦¬ í”„ë¡œë°”ì´ë” ë˜í•‘
- ì˜ì¡´ì„± ì£¼ì… ë° ì„œë¹„ìŠ¤ ì»¨í…Œì´ë„ˆ
- ì• í”Œë¦¬ì¼€ì´ì…˜ ìƒëª…ì£¼ê¸° ê´€ë¦¬

### `/store`
**ëª©ì **: ì§„ì •í•œ ì „ì—­ ìƒíƒœ ê´€ë¦¬ (ìµœì†Œí™” ê¶Œì¥)
- í˜„ì¬ ì¸ì¦ëœ ì‚¬ìš©ì ì •ë³´
- ì• í”Œë¦¬ì¼€ì´ì…˜ ì „ì—­ UI ìƒíƒœ (í…Œë§ˆ, ì–¸ì–´)
- ë„¤íŠ¸ì›Œí¬ ìƒíƒœ, ì˜¨ë¼ì¸/ì˜¤í”„ë¼ì¸
- ì‹œìŠ¤í…œ ì „ë°˜ì˜ ì„¤ì •ê°’

## ğŸ”’ ì˜ì¡´ì„± ê·œì¹™

### âœ… í—ˆìš©ë˜ëŠ” ì˜ì¡´ì„±
- **í•˜ìœ„ ë ˆì´ì–´**: Common ë ˆì´ì–´ì˜ ìœ í‹¸ë¦¬í‹°ì™€ íƒ€ì…
- **ì„œë¹„ìŠ¤ ë ˆì´ì–´**: ì¸ì¦, ì„¤ì • ë¡œë“œ ë“± ì¸í”„ë¼ ì„œë¹„ìŠ¤
- **ì „ì—­ ìƒíƒœ ê´€ë¦¬**: React Query, Zustand, Redux ë“±
- **í™˜ê²½ ì„¤ì •**: í™˜ê²½ë³€ìˆ˜, ì„¤ì • íŒŒì¼

### âŒ ê¸ˆì§€ë˜ëŠ” ì˜ì¡´ì„±
- **ìƒìœ„ ë ˆì´ì–´**: Shared, Domain, Feature, Routes
- **ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§**: ë„ë©”ì¸ íŠ¹í™” ë¡œì§ì´ë‚˜ ì—…ë¬´ ê·œì¹™
- **UI ì»´í¬ë„ŒíŠ¸**: êµ¬ì²´ì ì¸ ì»´í¬ë„ŒíŠ¸ êµ¬í˜„ì²´

## ğŸ—ï¸ ê¶Œì¥ í´ë” êµ¬ì¡°

```
src/global/
â”œâ”€â”€ index.ts              # Public API ì •ì˜
â”œâ”€â”€ README.md            # ë ˆì´ì–´ ê°€ì´ë“œ ë¬¸ì„œ
â”œâ”€â”€ config/              # ì• í”Œë¦¬ì¼€ì´ì…˜ ì„¤ì •
â”œâ”€â”€ providers/           # React ì»¨í…ìŠ¤íŠ¸ í”„ë¡œë°”ì´ë”
â””â”€â”€ store/               # ì „ì—­ ìƒíƒœ ê´€ë¦¬
```

## ğŸ“ ì„¤ê³„ ì›ì¹™

### ë‹¨ì¼ ì±…ì„ ì›ì¹™
- ê° ì„¤ì •ì€ ëª…í™•í•œ í•˜ë‚˜ì˜ ëª©ì ì„ ê°€ì ¸ì•¼ í•¨
- ì„œë¡œ ë‹¤ë¥¸ ê´€ì‹¬ì‚¬ëŠ” ë¶„ë¦¬ëœ ëª¨ë“ˆë¡œ ê´€ë¦¬
- ë³€ê²½ ì´ìœ ê°€ ë‹¤ë¥¸ ì„¤ì •ë“¤ì€ ë…ë¦½ì ìœ¼ë¡œ êµ¬ì„±

### ë¶ˆë³€ì„± ì›ì¹™
- ëŸ°íƒ€ì„ì— ë³€ê²½ë˜ì§€ ì•ŠëŠ” ì„¤ì •ê°’ë“¤
- í™˜ê²½ë³„ë¡œ ë‹¤ë¥´ì§€ë§Œ ë°°í¬ í›„ì—ëŠ” ê³ ì •ì ì¸ ê°’
- ì „ì—­ ìƒíƒœëŠ” ìµœì†Œí•œìœ¼ë¡œ ìœ ì§€í•˜ê³  ëª…í™•í•œ ë³€ê²½ ì¸í„°í˜ì´ìŠ¤ ì œê³µ

### ì˜ì¡´ì„± ì—­ì „ ì›ì¹™
- êµ¬ì²´ì ì¸ êµ¬í˜„ë³´ë‹¤ëŠ” ì¶”ìƒí™”ì— ì˜ì¡´
- í™˜ê²½ì— ë”°ë¼ ë‹¤ë¥¸ êµ¬í˜„ì²´ë¥¼ ì£¼ì…í•  ìˆ˜ ìˆëŠ” êµ¬ì¡°
- í…ŒìŠ¤íŠ¸ ê°€ëŠ¥í•œ ì„¤ì •ê³¼ í”„ë¡œë°”ì´ë” ì„¤ê³„

## ğŸ”„ ë¼ì´í”„ì‚¬ì´í´ ê´€ë¦¬

### ì• í”Œë¦¬ì¼€ì´ì…˜ ì´ˆê¸°í™” ìˆœì„œ
```typescript
// AppProvider.tsx
export const AppProvider = ({ children }: PropsWithChildren) => {
  useEffect(() => {
    // 1. ì„¤ì • ë¡œë“œ
    loadAppConfig();
    
    // 2. ì‚¬ìš©ì ì„¸ì…˜ ë³µì›
    restoreUserSession();
    
    // 3. ì˜¨ë¼ì¸ ìƒíƒœ ê°ì§€ ì‹œì‘
    startOnlineStatusDetection();
    
    // 4. ì• ë„ë¦¬í‹±ìŠ¤ ì´ˆê¸°í™” (ì„ íƒì )
    if (appConfig.features.enableAnalytics) {
      initializeAnalytics();
    }
  }, []);

  return (
    <QueryProvider>
      <ThemeProvider>
        <AuthProvider>
          {children}
        </AuthProvider>
      </ThemeProvider>
    </QueryProvider>
  );
};
```

### ì •ë¦¬(Cleanup) ì‘ì—…
```typescript
// ì• í”Œë¦¬ì¼€ì´ì…˜ ì¢…ë£Œ ì‹œ ì •ë¦¬ ì‘ì—…
useEffect(() => {
  const cleanup = () => {
    // 1. ì§„í–‰ ì¤‘ì¸ ìš”ì²­ ì·¨ì†Œ
    queryClient.cancelQueries();
    
    // 2. íƒ€ì´ë¨¸ ì •ë¦¬
    clearAllTimers();
    
    // 3. ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì œê±°
    removeEventListeners();
  };

  window.addEventListener('beforeunload', cleanup);
  return () => window.removeEventListener('beforeunload', cleanup);
}, []);
```

## âš ï¸ ì£¼ì˜ì‚¬í•­

### ê¸ˆì§€ì‚¬í•­
1. **ë„ë©”ì¸ ë¡œì§ í¬í•¨ ê¸ˆì§€**
   ```typescript
   // âŒ ê¸ˆì§€: íŠ¹ì • ë„ë©”ì¸ ë¡œì§
   export const calculateOrderTotal = (order: Order) => { /* ... */ }
   
   // âœ… ì˜¬ë°”ë¦„: ì „ì—­ ì„¤ì •
   export const currencyConfig = { symbol: '$', locale: 'en-US' };
   ```

2. **ìƒìœ„ ë ˆì´ì–´ import ê¸ˆì§€**
   ```typescript
   // âŒ ê¸ˆì§€
   import { UserCard } from '@/domain/user';
   import { useProductList } from '@/shared/hooks';
   
   // âœ… ì˜¬ë°”ë¦„
   import { authService } from '@/services/auth';
   import { HTTP_STATUS } from '@/common';
   ```

3. **ê³¼ë„í•œ ì „ì—­ ìƒíƒœ ê¸ˆì§€**
   ```typescript
   // âŒ ê¸ˆì§€: ëª¨ë“  ìƒíƒœë¥¼ ì „ì—­ìœ¼ë¡œ
   interface GlobalState {
     users: User[];
     products: Product[];
     orders: Order[];
     // ... ë„ˆë¬´ ë§ì€ ë„ë©”ì¸ ìƒíƒœ
   }
   
   // âœ… ì˜¬ë°”ë¦„: ì§„ì§œ ì „ì—­ ìƒíƒœë§Œ
   interface GlobalState {
     user: User | null;      // í˜„ì¬ ë¡œê·¸ì¸ ì‚¬ìš©ì
     theme: ThemeMode;       // UI í…Œë§ˆ
     language: Language;     // ì–¸ì–´ ì„¤ì •
     isOnline: boolean;      // ì˜¨ë¼ì¸ ìƒíƒœ
   }
   ```

## ğŸ§ª í…ŒìŠ¤íŠ¸ ê°€ì´ë“œ

### Provider í…ŒìŠ¤íŠ¸
```typescript
// AppProvider.test.tsx
describe('AppProvider', () => {
  it('should provide query client to children', () => {
    const TestComponent = () => {
      const queryClient = useQueryClient();
      return <div data-testid="query-client">{queryClient ? 'present' : 'absent'}</div>;
    };

    render(
      <AppProvider>
        <TestComponent />
      </AppProvider>
    );

    expect(screen.getByTestId('query-client')).toHaveTextContent('present');
  });
});
```

### ì „ì—­ ìƒíƒœ í…ŒìŠ¤íŠ¸
```typescript
// globalStore.test.ts
describe('globalStore', () => {
  beforeEach(() => {
    useGlobalStore.getState().reset(); // ìƒíƒœ ì´ˆê¸°í™”
  });

  it('should update theme', () => {
    const { setTheme } = useGlobalStore.getState();
    
    act(() => {
      setTheme('dark');
    });

    expect(useGlobalStore.getState().theme).toBe('dark');
  });
});
```

## ğŸ“ˆ ì„±ëŠ¥ ìµœì í™”

### Context ë¶„ë¦¬
```typescript
// ì„±ëŠ¥ì„ ìœ„í•´ ì»¨í…ìŠ¤íŠ¸ë¥¼ ë¶„ë¦¬
export const UserProvider = ({ children }: PropsWithChildren) => {
  // ì‚¬ìš©ì ê´€ë ¨ ìƒíƒœë§Œ ê´€ë¦¬
};

export const ThemeProvider = ({ children }: PropsWithChildren) => {
  // í…Œë§ˆ ê´€ë ¨ ìƒíƒœë§Œ ê´€ë¦¬
};

// í•„ìš”í•œ ì»¨í…ìŠ¤íŠ¸ë§Œ ì„ íƒì ìœ¼ë¡œ ì‚¬ìš©
const UserProfile = () => {
  const { user } = useUser(); // ThemeProviderì™€ ë…ë¦½ì 
  return <div>{user?.name}</div>;
};
```

### ë©”ëª¨ì´ì œì´ì…˜ í™œìš©
```typescript
// ë¶ˆí•„ìš”í•œ ë¦¬ë Œë”ë§ ë°©ì§€
export const AppProvider = memo(({ children }: PropsWithChildren) => {
  const value = useMemo(() => ({
    config: appConfig,
    // ... ë‹¤ë¥¸ ê°’ë“¤
  }), []);

  return (
    <AppContext.Provider value={value}>
      {children}
    </AppContext.Provider>
  );
});
```

ì´ ë ˆì´ì–´ëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ **ì „ì—­ì ì¸ ìƒíƒœì™€ ì„¤ì •**ì„ ê´€ë¦¬í•˜ì—¬ ì¼ê´€ëœ ì‚¬ìš©ì ê²½í—˜ì„ ì œê³µí•©ë‹ˆë‹¤.